/*!
 * Copyright (c) 2012 Mike Green <myatus@gmail.com>
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 *
 */
if(typeof cookillian==="undefined"){var cookillian={}}(function(b){if(!b.isFunction(b.fn.showHide)){b.fn.showHide=function(a){var d=b(this[0]);if(a){d.fadeIn("slow")}else{d.fadeOut("slow")}return this}}b.extend(cookillian,{getAjaxData:function(a,j,g){var h=(typeof g==="function"),i=false;b.ajax({type:"POST",dataType:"json",url:cookillian_ajax.url,timeout:5000,async:h,data:{action:cookillian_ajax.action,func:a,data:j,_ajax_nonce:cookillian_ajax.nonce},success:function(c){if(c.nonce===cookillian_ajax.nonceresponse&&c.stat==="ok"){i=c.data;if(h){g(i)}}}});return i},showHideCustomAlert:function(){var a=b('input[name="alert_content_type"]:checked'),f=b(".alert_normal"),g=b(".alert_custom"),h;if(!a.length){return}h=(a.val()==="custom");g.showHide(h);f.showHide(!h)},showHideCustomAlertStyle:function(){var d=b('input[name="alert_style"]:checked'),a=b(".alert_custom_style_extra");if(!d.length){return}a.showHide(d.val()==="custom")},showHideExtras:function(){var d=b(".maxmind_settings"),a=b('input[name="geo_service"]:checked');if(!a.length){return}d.showHide(a.val()==="maxmind")},initSettingsPage:function(){var a=b("#clear_geo_cache");b(".multi_checkbox li").each(function(){var h=b(this),f=b('input[type="checkbox"]',this),g=f.is(":checked");if(g){h.addClass("highlighted")}f.change(function(c){h.toggleClass("highlighted")})});a.click(function(d){a.prop("disabled",true).css("cursor","wait");cookillian.getAjaxData("clear_geo_cache",true,function(){a.prop("disabled",false).css("cursor","")});d.preventDefault()});b('input[name="alert_content_type"]').change(cookillian.showHideCustomAlert);cookillian.showHideCustomAlert();b('input[name="alert_style"]').change(cookillian.showHideCustomAlertStyle);cookillian.showHideCustomAlertStyle();b('input[name="geo_service"]').change(cookillian.showHideExtras);cookillian.showHideExtras();b("#footer_debug_link").click(function(){b("#footer_debug").toggle();return false})},initCookiePage:function(){var m=b(".cookie_table .delete-btn"),i=b(".group-dropdown"),l=b(".cookie_table"),j,k,n,a;if(l.length){b(".col_blank",l).width(l.width()-b("table",l).width())}b("#add_new_cookie_btn").click(function(){n="new_"+Math.floor((Math.random()*99999));j=b("#row_clonable").clone(true);j.prop("id","row_"+n);b('.col_name input[type="text"]',j).prop("name","known_cookies["+n+"][name]");b(".col_desc textarea",j).prop("name","known_cookies["+n+"][desc]");b('.col_group input[type="text"]',j).prop("name","known_cookies["+n+"][group]");b('.col_req input[type="checkbox"]',j).prop("name","known_cookies["+n+"][required]");b(".col_del button",j).attr("data-row","row_"+n);j.prependTo(b("table tbody",l)).fadeIn("slow");b("input:first",l).focus();return false});if(m.length){m.click(function(c){k=b("#"+b(this).attr("data-row"));if(k.length){b(".delete-cb",k).prop("checked",true);k.fadeOut("slow",function(){if(!b(".delete-cb",k).length){k.remove()}})}c.preventDefault()})}if(i.length){b("select",i).change(function(){b('input[type="text"]',b(this).closest("td")).val(b(":selected",this).val())});b(".edit-group",i.parent()).click(function(c){a=b(this).parent();if(b(this).hasClass("add")){b(this).text(cookillian_translate.sel_cookie_group);b('input[type="text"]',a).show().focus();b("select",a).hide()}else{b(this).text(cookillian_translate.add_cookie_group);b('input[type="text"]',a).hide();b("select",a).show()}b(this).toggleClass("add");c.preventDefault()})}},initStatsPage:function(){var a=b("#stats_form"),d;if(!a.length){return}b("#clear-stats").click(function(c){if(!confirm(cookillian_translate.are_you_sure)){c.preventDefault()}});b(".month-row").click(function(){d=b("."+b(this).attr("id")+"_details");if(b(this).hasClass("expanded")){b(this).removeClass("expanded");b(".collapse-btn",this).html("&#9660;");d.fadeOut()}else{b(this).addClass("expanded");b(".collapse-btn",this).html("&#9650;");d.fadeIn()}})}});b(document).ready(function(a){cookillian.initSettingsPage();cookillian.initCookiePage();cookillian.initStatsPage()})}(jQuery));